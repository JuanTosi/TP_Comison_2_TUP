CREATE DATABASE  cultura_municipalidad;
USE cultura_municipalidad;

-- Tabla de lugares
CREATE TABLE lugares (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nombre VARCHAR(200) NOT NULL,
    tipo ENUM('plaza', 'teatro', 'museo', 'centro_cultural', 'auditorio', 'galeria', 'parque', 'otro') DEFAULT 'otro',
    direccion TEXT NOT NULL,
    capacidad_maxima INT NOT NULL,
    contacto_nombre VARCHAR(150),
    contacto_telefono VARCHAR(20),
    contacto_email VARCHAR(100),
    equipamiento TEXT,
    activo BOOLEAN DEFAULT TRUE,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabla de eventos 
CREATE TABLE eventos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nombre VARCHAR(200) NOT NULL,
    descripcion TEXT,
    fecha_inicio DATETIME NOT NULL,
    fecha_fin DATETIME NOT NULL,
    lugar_id INT NOT NULL,
    entradas_vendidas INT DEFAULT 0,  
    precio_entrada DECIMAL(10,2) DEFAULT 0.00,  
    activo BOOLEAN DEFAULT TRUE,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (lugar_id) REFERENCES lugares(id),
    CHECK (fecha_fin >= fecha_inicio)
);

-- Tabla de artistas
CREATE TABLE artistas (
    id INT PRIMARY KEY AUTO_INCREMENT,
    nombre VARCHAR(150) NOT NULL,
    tipo_arte ENUM('m√∫sica', 'teatro', 'danza', 'pintura', 'escultura', 'literatura', 'otro') DEFAULT 'otro',
    biografia TEXT,
    email VARCHAR(100),
    telefono VARCHAR(20),
    activo BOOLEAN DEFAULT TRUE,
    fecha_creacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

--  Artistas por Evento
CREATE TABLE artistas_eventos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    artista_id INT NOT NULL,
    evento_id INT NOT NULL,
    rol ENUM('principal', 'secundario', 'colaborador') DEFAULT 'principal',
    fecha_participacion TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (artista_id) REFERENCES artistas(id) ON DELETE CASCADE,
    FOREIGN KEY (evento_id) REFERENCES eventos(id) ON DELETE CASCADE,
    UNIQUE KEY unique_artista_evento (artista_id, evento_id)
);

-- TABLA  Ventas de boletos 
CREATE TABLE ventas_boletos (
    id INT PRIMARY KEY AUTO_INCREMENT,
    evento_id INT NOT NULL,
    cantidad_boletos INT NOT NULL,
    total_venta DECIMAL(10,2) NOT NULL,
    fecha_venta TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    metodo_pago ENUM('efectivo', 'tarjeta', 'transferencia') DEFAULT 'efectivo',
    FOREIGN KEY (evento_id) REFERENCES eventos(id) ON DELETE CASCADE
);